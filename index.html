<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GeoJSON Map with Toner Tiles</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    body { margin: 0; display: flex; height: 100vh; font-family: sans-serif; }
    #sidebar { width: 300px; overflow-y: auto; border-right: 1px solid #ccc; padding: 10px; background: #f9f9f9; }
    #map { flex: 1; }
    .feature-item { cursor: pointer; padding: 6px 8px; border-bottom: 1px solid #eee; }
    .feature-item:hover { background-color: #eaeaea; }
  </style>
</head>
<body>
  <div id="sidebar"></div>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([38.7, -9.1], 10);
    const sidebar = document.getElementById('sidebar');

    L.tileLayer('https://tiles.stadiamaps.com/tiles/stamen_toner/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a> &copy; <a href="https://stamen.com/">Stamen Design</a> &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
      maxZoom: 20
    }).addTo(map);

    const geojsonUrl = 'https://gist.githubusercontent.com/soobrosa/4ce1b3da0607bb26de65513416f342f3/raw/294726af137590182f7eff5dc0b575edd0599a40/ciee.geojson';

    fetch(geojsonUrl)
      .then(res => res.json())
      .then(data => {
        const geojsonLayer = L.geoJSON(data, {
          pointToLayer: (feature, latlng) => L.circleMarker(latlng, {
            radius: 6,
            fillColor: "#3388ff",
            color: "#000",
            weight: 1,
            fillOpacity: 0.8
          }),
          onEachFeature: (feature, layer) => {
            const props = feature.properties;
            const name = props.name || props.nome || "Unnamed Feature";

            const item = document.createElement('div');
            item.className = 'feature-item';
            item.textContent = name;
            sidebar.appendChild(item);

            layer.bindPopup(`<strong>${name}</strong>`);

            const latlng = layer.getLatLng();
            const zoomLevel = Math.max(map.getZoom(), 17);
            const flyToFeature = () => {
              map.flyTo(latlng, zoomLevel, { animate: true, duration: 0.75 });
              layer.openPopup();
            };

            item.onclick = flyToFeature;
            layer.on('click', flyToFeature);
          }
        }).addTo(map);

        map.fitBounds(geojsonLayer.getBounds());
      });
  </script>
</body>
</html>
